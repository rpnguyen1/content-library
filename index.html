<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Content Library Demo</title>
  <link rel="stylesheet" href="style.css">
  <!-- Add Inter font for a modern look -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap" rel="stylesheet">
</head>
<body>
  <header>
    <nav class="main-nav">
      <a class="active" href="index.html">Home</a>
      <a href="links.html">Links</a>
      <a href="about.html">About</a>
      <a href="faq.html">FAQ</a>
      <a href="tasks.html">Weekly Tasks</a>
      <a href="effects.html">Effects</a>
      <a href="trendreport.html">Trend Report</a>
      <a href="winners.html">Winners</a>
      <a href="tips.html">Tips</a>
    </nav>

    <div class="header-flex">
      <div class="header-info">
        <h1>Content Library Demo</h1>
        <h2>Everything on this page is completely copyright free and ready to be used for templates</h2>
        <p>They were sourced from royalty free sites like Pexels, Pixabay, and Mixkit and chosen by the Capcut Pro team for use in Templates.</p>
        <p>Just want the links to the sites? Go to <a href="links.html">Links</a>.</p>
      </div>
      <div class="header-announcement">
        <div class="box news">
          <div class="box-header">
            <h4>Announcements</h4>
          </div>
          <div class="box-content">
            <ul id="current-tasks-announcement">
              <!-- JS will fill this in -->
               
            </ul>

          </div>
        </div>
      </div>
    </div>

    <div class="filters">
      <input type="text" id="search" placeholder="Search by title or tag (use spaces for multiple terms)...">
      <select id="typeFilter">
        <option value="">All</option>
        <option value="video">Videos</option>
        <option value="photo">Photos</option>
      </select>
      <input type="hidden" id="categoryFilter">
    </div>
    <!-- Show selected categories as chips above the buttons -->
    <div id="selectedCategories" style="margin: 10px 0;"></div>
    <div id="categoryOptions" style="margin: 10px 0;"></div>
    <span id="resultsCount"></span>
  </header>

  <main id="video-container"></main>
  <script src="tasks.js"></script>
  <script src="script.js"></script>
  <script>
    // Find the most recent Pro Top and Pro Viral tasks
    function getMostRecentTask(group) {
      const now = new Date().toISOString().slice(0, 10);
      // Prefer current, else most recent past
      let current = tasks.filter(t => t.group === group && t.start && t.end && now >= t.start && now <= t.end);
      if (current.length) return current[0];
      // If none current, get the most recent past
      let past = tasks
        .filter(t => t.group === group && t.start && t.end && now > t.end)
        .sort((a, b) => b.end.localeCompare(a.end));
      return past[0] || null;
    }

    function renderCurrentTasksAnnouncement() {
      const ul = document.getElementById('current-tasks-announcement');
      if (!ul || typeof tasks === "undefined") return;
      ul.innerHTML = ""; // Clear old

      ["Pro Top", "Pro Viral"].forEach(group => {
        const task = getMostRecentTask(group);
        if (task) {
          // Find first line of content as summary
          const summary = (task.content.match(/Theme:([^\n]+)/i) || [])[1] ||
                          (task.content.match(/ðŸ”¥ Theme:([^\n]+)/i) || [])[1] ||
                          task.theme || "";
          ul.innerHTML += `
            <li>
              <div class="news-description">
                <h4>ðŸ“Œ (${task.week}) ${group} Task${task.theme ? ": " + task.theme : ""}</h4>
                <p>${summary ? summary.trim() : ""}
                  <a href="tasks.html">See details</a>
                </p>
              </div>
            </li>
          `;
        }
      });
    }

    // Run after DOM and tasks.js are loaded
    document.addEventListener('DOMContentLoaded', renderCurrentTasksAnnouncement);
  </script>
</body>
</html>
